<!doctype html>
<html lang="pt-br">
<head>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<title>Benefícios</title>
	<style>
		body { font-family: system-ui, sans-serif; margin: 2rem; }
		table { border-collapse: collapse; width: 100%; margin-top: 1rem; }
		th, td { border: 1px solid #ddd; padding: .5rem; text-align: left; }
		th { background: #f3f4f6; }
		section { margin-bottom: 2rem; }
		label { display: block; margin-top: .5rem; }
		input { padding: .4rem; }
		button { padding: .5rem 1rem; margin-top: .5rem; }
		.error { color: #b91c1c; }
	</style>
	<script>
		const api = 'http://localhost:8080/api/v1/beneficios';
		async function load() {
			const res = await fetch(api);
			const data = await res.json();
			const tbody = document.getElementById('tbody');
			tbody.innerHTML = data.map(b =>
					`<tr><td>${b.id}</td><td>${b.nome}</td><td>${b.descricao ?? ''}</td><td>${b.valor}</td><td>${b.ativo}</td></tr>`
			).join('');
		}
		async function create() {
			const payload = {
				nome: document.getElementById('nome').value,
				descricao: document.getElementById('descricao').value,
				valor: parseFloat(document.getElementById('valor').value),
				ativo: true
			};
			const res = await fetch(api, {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)});
			if (!res.ok) {
				document.getElementById('error').textContent = 'Falha: ' + await res.text();
			} else {
				document.getElementById('error').textContent = '';
				await load();
			}
		}
		async function transfer() {
			const payload = {
				fromId: Number(document.getElementById('fromId').value),
				toId: Number(document.getElementById('toId').value),
				amount: parseFloat(document.getElementById('amount').value)
			};
			const res = await fetch(api + '/transfer', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)});
			if (!res.ok) {
				document.getElementById('error').textContent = 'Falha: ' + await res.text();
			} else {
				document.getElementById('error').textContent = '';
				await load();
			}
		}
		window.addEventListener('DOMContentLoaded', load);
	</script>
</head>
<body>
<h1>Benefícios</h1>
<p><a href="http://localhost:8080/swagger-ui.html" target="_blank" rel="noreferrer">Swagger da API</a></p>
<div id="error" class="error"></div>

<section>
	<h2>Lista de benefícios</h2>
	<button onclick="load()">Atualizar lista</button>
	<table>
		<thead><tr><th>ID</th><th>Nome</th><th>Descrição</th><th>Valor</th><th>Ativo</th></tr></thead>
		<tbody id="tbody"></tbody>
	</table>
	<p>O backend inicia com dois registros de exemplo.</p>
	<p>Para abrir esta página, utilize o navegador ou um servidor estático.</p>
	<p>No Windows PowerShell: <code>powershell -c \"cd frontend; Start-Process msedge .\\index.html\"</code></p>
</section>

<section>
	<h2>Novo benefício</h2>
	<label>Nome <input id="nome" /></label>
	<label>Descrição <input id="descricao" /></label>
	<label>Valor <input id="valor" type="number" step="0.01" /></label>
	<button onclick="create()">Salvar</button>
	<p>Após salvar, utilize os IDs para realizar transferências.</p>
	<p>Exemplo: transferir 200,00 do ID 1 para o ID 2.</p>
</section>

<section>
	<h2>Transferência entre benefícios</h2>
	<label>Origem (ID) <input id="fromId" type="number" /></label>
	<label>Destino (ID) <input id="toId" type="number" /></label>
	<label>Valor <input id="amount" type="number" step="0.01" /></label>
	<button onclick="transfer()">Transferir</button>
</section>

</body>
</html>


